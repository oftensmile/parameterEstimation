\documentclass[11pt]{article}
\usepackage[top=20mm, bottom=30mm, left = 20mm, right=20mm]{geometry}%Set blank space of this article
\usepackage{graphicx}
\usepackage{float}
\setlength{\parindent}{1cm}
\begin{document}
\begin{abstract}
<<<<<<< HEAD
MPF及びCD-methodのobjection functionを整理したノートです。
\end{abstract}

\section{CD-method}
\begin{eqnarray}
	CD(p^{(0)}\|p^{(1)})&:=&KL(p^{(0)}\|p^{(\infty)})-KL(p^{(1)}\|p^{(\infty)})\\
	&=&\sum_{x}p^{(0)}(x)\log(\frac{p^{(0)}(x)}{p^{(\infty)}(x|\theta)})-\sum_{x}p^{(1)}(x|\theta)\log(\frac{p^{(1)}(x|\theta)}{p^{(\infty)}(x|\theta)})\\
	&=&-\sum_{x}p^{(0)}(x)\log(p^{(\infty)}(x|\theta)) + \sum_{x}p^{(1)}(x|\theta)\log (\frac{p^{(1)}(x|\theta)}{p^{(\infty)}(x|\theta)})+const
\end{eqnarray}
ただし、$p^{(0)}$は経験分布。$p^{(1)}$は経験分布から1MC-stepで到達できる確率分とします。一次元(サイト数d)イジングモデル、かつ、パラメータが一様(一変数)の場合は分配関数を簡単に書くことができ、以下のような式になります。
\begin{equation}
	Z(\theta)=(2\cosh(\theta))^d+(2\sinh(\theta))^d
\end{equation}
\begin{equation}
	p^{(0)}(x)=\frac{1}{|{\mathcal D}|}\sum_{y\in {\mathcal D}} \prod_{j=1}^{d} \delta(x_j,y_j)
\end{equation}


従って、第1項目は
\begin{equation}
	\sum_{x}p^{(0)}(x)\log(\frac{p^{(0)}(x)}{p^{(\infty)}(x|\theta)})= 
	\frac{1}{|{\mathcal D}|}\{-\sum_{x\in{\mathcal D}}E(x|\theta)-\log((2\cosh(\theta))^d+(2\sinh(\theta))^d) \}-\log(|{\mathcal D}|)
\end{equation}
1MC-stepの遷移で得られる確率分布は以下のように考えました。\\
まずは、初期状態と次の遷移先の同時確率を、初期状態の変数を周辺化するとみなします($p^{(1)}(x)$は一度の遷移で到達でき変数の確率分布であるため)。
\begin{equation}
	p^{(1)}(x)=\sum_{x':all}p(x|x')p(x')^{(0)}=\sum_{x'\in {\mathcal D}}p(x|x')\frac{1}{|{\mathcal D}|}
\end{equation}
経験分布はデータに含まれている状態のみ有限の値を持つとします\\
\begin{equation}
	p^{(0)}(x)={\large \{ }
	\begin{array}{ll}
		\frac{1}{|{\mathcal D}|} & \ {\rm for }\ x\in {\mathcal D} \\
		0  & \ {\rm for }\ x\not \in {\mathcal D}
	\end{array}
\end{equation}
また、$p(x|x')$はhumming距離1,0またはそれ以上かの3通り場合分けをして考えます。\\
\begin{equation}
	p(x|x')={\large\{ }
	\begin{array}{ll}
		d^{-1}(1+\exp\{-E(x'|\theta)+E(x|\theta)\})^{-1} & {\rm for}\ \|x-x'\|=1 \\
		1-\sum_{x:{\rm all},\|x-x'\|=1} d^{-1} \{1+\exp(-E(x'|\theta)+E(x|\theta)) \}^{-1} & {\rm for}\ \|x-x'\|=0 \\
		0  & {\rm for}\ \|x-x'\| > 1
	\end{array}
\end{equation}
$x=x'$の場合は任意の確率変数$x,y$に対して、$\sum_{x:all}p(x|y)=1$であることから導かれます。\\
従って、1MC-stepで遷移可能な確率分布は\\
\begin{eqnarray}
	p^{(1)}(x)&=&|{\mathcal D}|^{-1}\sum_{x'\in{\mathcal D}}p(x|x')\\
				       &=&|{\mathcal D}|^{-1}\sum_{x'\in{\mathcal D}, \|x-x'\|=1}p(x|x')+|{\mathcal D}|^{-1}\sum_{x'\in {\mathcal D}:x'=x}p(x|x')
\end{eqnarray}
この$p^{(1)}$をCDの第2項目に代入すれば良いのだと思います。\\
\section{MPF}
1MC-stepの遷移で得られるMPFのobjective-functionは
\begin{equation}
	MPF(\theta)=KL(p^{(0)}\|p^{(1)})=-\sum_{x:all}p^{(0)}(x)\log(p^{(1)}(x|\theta)) + const
\end{equation}
CDの章で得られた$p^{(1)}$を用いると以下の式を得られます
\begin{eqnarray}
	MPF(\theta)&=&-\sum_{x:all}p^{(0)}(x)\log(p^{(1)}(x|\theta))\\
	&=&-\frac{1}{|\mathcal D|}\sum_{x\in {\mathcal D}} \log(p^{(1)}(x|\theta))\\
	&=&-\frac{1}{|\mathcal D|}\sum_{x\in {\mathcal D}} \log\{ \sum_{x'\in {\mathcal D}, \|x-x'\|=1 }\{ d^{-1}(1+\exp\{-E(x'|\theta)+E(x|\theta)\})^{-1} \}\\ &&+1-\sum_{x':{\rm all},\|x-x'\|=1} d^{-1} \{1+\exp(-E(x|\theta)+E(x'|\theta)) \}^{-1}  \} \} 
	%&=&-\frac{1}{|\mathcal D|}\sum_{x\in {\mathcal D}} \log\{ 1-\sum_{x'\not \in {\mathcal D}, \|x-x'\|=1 }\{ d^{-1}(1+\exp\{-E(x'|\theta)+E(x|\theta)\})^{-1} \}   \}
\end{eqnarray}
式の意味としては、最初の状態点に1MC-step先でも止まる確率分布となっています。
(たぶん、最後の行が間違っているのではないかと思います。)\\
一応$MPF(\theta)$の一次元d=16,パラメータ数が1つ(真値$=0.5$)の場合で、プロットすると以下の様な図を得ました(本来局値に成るべき$0.5$に局値が現れません。何かが変です。)。\\
縦軸はMPFの値で、横軸はパラメータです。
\begin{center}
	\includegraphics[width=10cm]{MPF-landscape.eps}\\
	  landscape of MPF
  \end{center}
\section{整理し直し}
$p^{(1)}(x|\theta)$をもう一度考え直して


%\bibliography{main}
\end{document}
%Below of this line is not printed
